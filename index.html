<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>29 Seconds</title>
    <script src="//www.gstatic.com/cast/sdk/libs/receiver/2.0.0/cast_receiver.js"></script>
    <link rel="stylesheet" href="app.css" type="text/css" />
    <script src="phaser.js"></script>
    <script src="app.js"></script>
    <script src="Game.js"></script>
    <script src="Boot.js"></script>
    <script src="Preloader.js"></script>
    <script src="MainMenu.js"></script>
    <script src="Board.js"></script>
    <script src="Team1.js"></script>
    <script src="Team2.js"></script>


</head>
<body>

    <!--<script>
        window.mediaElement = document.getElementById('content');
        window.mediaManager = new cast.receiver.MediaManager(window.mediaElement);
        window.castReceiverManager = cast.receiver.CastReceiverManager.getInstance();
        //window.customMessageBus = CustomReceiver.castReceiverManager.getCastMessageBus(CustomReceiver.Namespace);
        window.castReceiverManager.start();
    </script>-->
    <!-- Some Code pulled from https://github.com/googlecast/CastHelloText-android/blob/master/receiver/receiver.html-->

    <DIV id="content"></DIV>
    <script src="//www.gstatic.com/cast/sdk/libs/receiver/2.0.0/cast_receiver.js"></script>
    <script type="text/javascript">
        
            cast.receiver.logger.setLevelValue(0);
            window.castReceiverManager = cast.receiver.CastReceiverManager.getInstance();
            console.log('Starting Receiver Manager');

            // handler for the 'ready' event
            castReceiverManager.onReady = function (event) {
                console.log('Received Ready event: ' + JSON.stringify(event.data));
                window.castReceiverManager.setApplicationState("Application status is ready...");
            };

            // handler for 'senderconnected' event
            castReceiverManager.onSenderConnected = function (event) {
                console.log('Received Sender Connected event: ' + event.data);
                console.log(window.castReceiverManager.getSender(event.data).userAgent);
            };

            // handler for 'senderdisconnected' event
            castReceiverManager.onSenderDisconnected = function (event) {
                console.log('Received Sender Disconnected event: ' + event.data);
                if (window.castReceiverManager.getSenders().length == 0) {
                    window.close();
                }
            };

            // handler for 'systemvolumechanged' event
            castReceiverManager.onSystemVolumeChanged = function (event) {
                console.log('Received System Volume Changed event: ' + event.data['level'] + ' ' +
                    event.data['muted']);
            };
            // create a CastMessageBus to handle messages for a custom namespace
            window.messageBus =
              window.castReceiverManager.getCastMessageBus(
                  'urn:x-cast:TNSeconds');
            // handler for the CastMessageBus message event
            window.messageBus.onMessage = function (event) {
                console.log('Message [' + event.senderId + ']: ' + event.data);
                // display the message from the sender
                displayText(event.data);
                // inform all senders on the CastMessageBus of the incoming message event
                // sender message listener will be invoked
                window.messageBus.send(event.senderId, event.data);
            }

            var appConfig = new cast.receiver.CastReceiverManager.Config();

            
            appConfig.statusText = 'Ready to play';

            // 100 minutes for testing, use default 10sec in prod by not setting this value
            appConfig.maxInactivity = 6000;

            // initialize the CastReceiverManager with an application status message
            window.castReceiverManager.start(appConfig);
            console.log('Receiver Manager started');
            

        // utility function to display the text message in the input field
        function displayText(text) {
            console.log(text);
            //document.getElementById("message").innerHTML = text;
            //window.castReceiverManager.setApplicationState(text);
        };
    </script>

</body>
</html>
